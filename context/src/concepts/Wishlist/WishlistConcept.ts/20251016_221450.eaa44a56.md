---
timestamp: 'Thu Oct 16 2025 22:14:50 GMT-0400 (Eastern Daylight Time)'
content_id: eaa44a5661f6aaf55375cf789bf7cf8847c0e22f6d767e396d8477ac6dea2cbc
---

# file: src/concepts/Wishlist/WishlistConcept.ts

```typescript
import { Collection, Db } from "npm:mongodb";
import { Empty, ID } from "@utils/types.ts";
import { freshID } from "@utils/database.ts";

// Collection prefix to ensure namespace separation
const PREFIX = "Wishlist" + ".";

// Generic types for the concept's external dependencies
type User = ID;

// Internal entity types, represented as IDs
type Place = ID;

/**
 * State: A set of Places with a user, city, region, and country.
 */
export interface PlaceDoc {
  _id: Place;
  user: User;
  city: string;
  region: string;
  country: string;
}

/**
 * @concept Wishlist
 * @purpose To keep track of a user's future dream destinations.
 */
export default class WishlistConcept {
  places: Collection<PlaceDoc>;

  constructor(private readonly db: Db) {
    this.places = this.db.collection(PREFIX + "places");
  }

  /**
   * Action: Adds a new place for a user.
   * @requires a place doesn't already exist in the set of places
   * with the given user, city, region, and country
   * @effects adds and returns a place with the given user, city, region, and country
   */
  async addPlace(
    { user, city, region, country }: {
      user: User;
      city: string;
      region: string;
      country: string;
    },
  ): Promise<{ place: Place } | { error: string }> {
    // checks place doesn't already exist for user
    const existingPlace = await this.places.findOne({
      user,
      city,
      region,
      country,
    });

    if (existingPlace) {
      return {
        error:
          `Place "${city}, ${region}, ${country}" already exists for user with ID ${user}.`,
      };
    }

    // adds place
    const newPlaceId = freshID() as Place;

    await this.places.insertOne({
      _id: newPlaceId,
      user,
      city,
      region,
      country,
    });

    return { place: newPlaceId };
  }

  /**
   * Action: Removes a place from an existing wishlist.
   * @requires place exists in set of places and user is its creator
   * @effects removes the place from the set of places
   */
  async removePlace(
    { user, place }: {
      user: User;
      place: Place;
    },
  ): Promise<Empty | { error: string }> {
    // checks place already exists for user
    const currPlace = await this.places.findOne({ _id: place, user: user });
    if (!currPlace) {
      return { error: `Place not in user with ID ${user}'s wishlist.` };
    }

    // removes place
    await this.places.deleteOne({ _id: place });
    return {};
  }

  /**
   * Query: Retrieves a user's places.
   * @effects returns all places for a given user
   */
  async _getPlaces(
    { user }: { user: User },
  ): Promise<PlaceDoc[]> {
    return await this.places.find({ user: user }).toArray();
  }
}

```
