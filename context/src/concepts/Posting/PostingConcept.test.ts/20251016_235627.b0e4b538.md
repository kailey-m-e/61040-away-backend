---
timestamp: 'Thu Oct 16 2025 23:56:27 GMT-0400 (Eastern Daylight Time)'
content_id: b0e4b53823840101d9e8def20c67a3327dea27638b49b83a25edcd35726797f6
---

# file: src/concepts/Posting/PostingConcept.test.ts

```typescript
import {
  assert,
  assertEquals,
  assertExists,
  assertNotEquals,
} from "jsr:@std/assert";
import { testDb } from "@utils/database.ts";
import { Empty, ID } from "@utils/types.ts";
import PostingConcept from "./PostingConcept.ts";

const creatorA = "creator:Alice" as ID;
const creatorB = "creator:Bob" as ID;
const nonPost = "post:nonPost" as ID;

/**
 * Test Case 1
 * Demonstrates operational principle: user creates and then edits a post.
 */
Deno.test("Test Case 1 - operational principle", async () => {
  const [db, client] = await testDb();
  const postingConcept = new PostingConcept(db);

  try {
    const posts0 = await postingConcept._getPosts({ user: creatorA });
    assertEquals(posts0.length, 0, "The user should have 0 posts.");

    // 1. Creator makes post
    const title = "Newport Trip";
    const city = "Newport";
    const region = "Rhode Island";
    const country = "United States";
    const start = new Date(2025, 9, 14);
    const end = new Date(2025, 9, 14);
    const description = "Class of 2027 trip to Newport, RI!";

    const createPost = await postingConcept.create({
      creator: creatorA,
      title,
      city,
      region,
      country,
      start,
      end,
      description,
    });
    assertNotEquals(
      "error" in createPost,
      true,
      "Post creation should not fail.",
    );
    const { post } = createPost as { post: ID };
    assertExists(post);

    const posts = await postingConcept._getPosts({ user: creatorA });
    assertEquals(posts.length, 1, "The user should have 1 post.");

    // 2. Creator edits post
    const newTitle = "Rhode Island Trip";
    const editTitle = await postingConcept.editTitle({
      user: creatorA,
      post,
      title: newTitle,
    });
    assertNotEquals(
      "error" in editTitle,
      true,
      "Editing title should not fail.",
    );
  } finally {
    await client.close();
  }
});

/**
 * Test Case 2
 * Demonstrates user creates, edits, and deletes multiple posts.
 */
Deno.test("Test Case 2 - multiple posts with create, edit, delete", async () => {
  const [db, client] = await testDb();
  const postingConcept = new PostingConcept(db);

  try {
    // 1. Creator makes post #1
    const createPost1 = await postingConcept.create({
      creator: creatorA,
      title: "Newport Trip",
      city: "Newport",
      region: "Rhode Island",
      country: "United States",
      start: new Date(2025, 9, 14),
      end: new Date(2025, 9, 14),
      description: "Class of 2027 trip to Newport, RI!",
    });
    const { post: post1 } = createPost1 as { post: ID };

    // 2. Creator makes post #2
    const createPost2 = await postingConcept.create({
      creator: creatorA,
      title: "Virigina Wedding",
      city: "Charlottlesville",
      region: "Virginia",
      country: "United States",
      start: new Date(2025, 9, 5),
      end: new Date(2025, 9, 6),
      description: "Weekend wedding in Virginia!",
    });
    const { post: post2 } = createPost2 as { post: ID };

    let posts = await postingConcept._getPosts({ user: creatorA });
    assertEquals(posts.length, 2, "The user should have 2 posts.");

    // 2. Creator edits post #2
    const newStart = new Date(2025, 7, 5);
    const newEnd = new Date(2025, 7, 7);
    const editDates = await postingConcept.editDates({
      user: creatorA,
      post: post2,
      start: newStart,
      end: newEnd,
    });
    assertNotEquals(
      "error" in editDates,
      true,
      "Editing dates should not fail.",
    );
    posts = await postingConcept._getPosts({ user: creatorA });
    assertEquals(
      posts[1].start,
      newStart,
      "Start date not updated.",
    );
    assertEquals(
      posts[1].end,
      newEnd,
      "End date not updated.",
    );

    const editDescription = await postingConcept.editDescription({
      user: creatorA,
      post: post2,
      description: "Beautiful weekend wedding in Virginia!",
    });
    assertNotEquals(
      "error" in editDescription,
      true,
      "Editing description should not fail.",
    );
    posts = await postingConcept._getPosts({ user: creatorA });
    assertEquals(
      posts[1].description,
      "Beautiful weekend wedding in Virginia!",
      "Desription not updated.",
    );

    // 3. Creator deletes post #2
    const deletePost2 = await postingConcept.delete({
      user: creatorA,
      post: post2,
    });
    assertEquals(
      "error" in deletePost2,
      false,
      "Deleting post should not fail.",
    );

    posts = await postingConcept._getPosts({ user: creatorA });
    assertEquals(posts.length, 1, "The user should have 1 post.");

    // 3. Creator makes post #3
    const createPost3 = await postingConcept.create({
      creator: creatorA,
      title: "New York Visit",
      city: "Manhattan",
      region: "New York",
      country: "United States",
      start: new Date(2025, 7, 30),
      end: new Date(2025, 8, 1),
      description: "Tourist trip to New York!",
    });
    const { post: post3 } = createPost3 as { post: ID };

    posts = await postingConcept._getPosts({ user: creatorA });
    assertEquals(posts.length, 2, "The user should have 2 post.");

    // 4. Creator edits post #3
    const editPlace = await postingConcept.editPlace({
      user: creatorA,
      post: post3,
      city: "New York",
      region: "New York",
      country: "United States",
    });
    assertNotEquals(
      "error" in editPlace,
      true,
      "Editing place should not fail.",
    );
    posts = await postingConcept._getPosts({ user: creatorA });
    assertEquals(
      posts[1].city,
      "New York",
      "City not updated.",
    );
    assertEquals(
      posts[1].region,
      "New York",
      "Region not updated.",
    );
    assertEquals(
      posts[1].country,
      "United States",
      "Country not updated.",
    );

    // 5. Creator deletes post #1
    const deletePost1 = await postingConcept.delete({
      user: creatorA,
      post: post1,
    });
    assertEquals(
      "error" in deletePost1,
      false,
      "Deleting post should not fail.",
    );

    posts = await postingConcept._getPosts({ user: creatorA });
    assertEquals(posts.length, 1, "The user should have 1 post.");
  } finally {
    await client.close();
  }
});

/**
 * Test Case 3
 * Demonstrates user tries to edit and delete post that they didn't create.
 */
Deno.test("Test Case 3 - edit/delete another user's post", async () => {
  const [db, client] = await testDb();
  const postingConcept = new PostingConcept(db);

  try {
    // 1. CreatorA makes post
    const makePost = await postingConcept.create({
      creator: creatorA,
      title: "Newport Trip",
      city: "Newport",
      region: "Rhode Island",
      country: "United States",
      start: new Date(2025, 9, 14),
      end: new Date(2025, 9, 14),
      description: "Class of 2027 trip to Newport, RI!",
    });

    const { post: post1 } = makePost as { post: ID };

    // 2. CreatorB tries to edit that post
    const newTitle = "Rhode Island Trip";
    const editTitle = await postingConcept.editTitle({
      user: creatorB,
      post: post1,
      title: newTitle,
    });
    assertEquals(
      "error" in editTitle,
      true,
      "Editing post with a different creator should fail.",
    );

    // 3. CreatorB tries to delete that post
    const deletePost = await postingConcept.delete({
      user: creatorB,
      post: post1,
    });
    assertEquals(
      "error" in deletePost!,
      true,
      "Deleting post with a different creator should fail.",
    );
  } finally {
    await client.close();
  }
});

/**
 * Test Case 4
 * Demonstrates user tries to edit and delete post that doesn't exist.
 */
Deno.test("Test Case 4 - edit/delete nonexistent post", async () => {
  const [db, client] = await testDb();
  const postingConcept = new PostingConcept(db);

  try {
    // 1. User tries to edit post that doesn't exist
    const newTitle = "Rhode Island Trip";
    const editTitle = await postingConcept.editTitle({
      user: creatorA,
      post: nonPost,
      title: newTitle,
    });
    assertEquals(
      "error" in editTitle,
      true,
      "Editing nonexistant post should fail.",
    );

    // 2. User tries to delete post that doesn't exist
    const deletePost = await postingConcept.delete({
      user: creatorA,
      post: nonPost,
    });
    assertEquals(
      "error" in deletePost!,
      true,
      "Deleting nonexistant post should fail.",
    );
  } finally {
    await client.close();
  }
});

/**
 * Test Case 5
 * Demonstrates multiple users make posts.
 */
Deno.test("Test Case 5 - multiple users", async () => {
  const [db, client] = await testDb();
  const postingConcept = new PostingConcept(db);

  try {
    // 1. CreatorA makes post
    await postingConcept.create({
      creator: creatorA,
      title: "Newport Trip",
      city: "Newport",
      region: "Rhode Island",
      country: "United States",
      start: new Date(2025, 9, 14),
      end: new Date(2025, 9, 14),
      description: "Class of 2027 trip to Newport, RI!",
    });

    // 2. CreatorA makes post
    await postingConcept.create({
      creator: creatorA,
      title: "Weekend Vacation",
      city: "New York",
      region: "New York",
      country: "United States",
      start: new Date(2025, 5, 12),
      end: new Date(2025, 5, 14),
      description: "Fun escape to NYC!",
    });

    // 2. CreatorB makes post
    await postingConcept.create({
      creator: creatorB,
      title: "Virigina Wedding",
      city: "Charlottlesville",
      region: "Virginia",
      country: "United States",
      start: new Date(2025, 9, 5),
      end: new Date(2025, 9, 6),
      description: "Weekend wedding in Virginia!",
    });

    const postsA = await postingConcept._getPosts({ user: creatorA });
    assertEquals(postsA.length, 2, "User A should have 2 posts.");

    const postsB = await postingConcept._getPosts({ user: creatorB });
    assertEquals(postsB.length, 1, "User B should have 1 post.");
  } finally {
    await client.close();
  }
});

/**
 * Test Case 6
 * Demonstrates user tries to make posts with invalid dates.
 */
Deno.test("Test Case 6 - posts invalid dates", async () => {
  const [db, client] = await testDb();
  const postingConcept = new PostingConcept(db);

  try {
    // 1. user makes post with future dates
    const makePost1 = await postingConcept.create({
      creator: creatorA,
      title: "Newport Trip",
      city: "Newport",
      region: "Rhode Island",
      country: "United States",
      start: new Date(2026, 9, 14),
      end: new Date(2026, 9, 14),
      description: "Class of 2027 trip to Newport, RI!",
    });

    assertEquals(
      "error" in makePost1,
      true,
      "Post with future dates should fail.",
    );

    // 1. user makes post with end date before start
    const makePost2 = await postingConcept.create({
      creator: creatorA,
      title: "Newport Trip",
      city: "Newport",
      region: "Rhode Island",
      country: "United States",
      start: new Date(2025, 9, 14),
      end: new Date(2025, 8, 14),
      description: "Class of 2027 trip to Newport, RI!",
    });

    assertEquals(
      "error" in makePost2,
      true,
      "Post with end date before start date should fail.",
    );
  } finally {
    await client.close();
  }
});

```
